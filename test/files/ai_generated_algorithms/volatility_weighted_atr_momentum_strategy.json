{
  "id": "volatility_weighted_atr_momentum_strategy",
  "name": "Volatility-Weighted ATR Momentum Strategy",
  "description": "This strategy utilizes the Average True Range (ATR) to gauge market volatility and applies a momentum approach to capitalize on price movements. By incorporating volume-weighted metrics, it aims to enhance trade entries and exits based on market conditions.",
  "algorithm_type": "Momentum",
  "prompt": "//@version=5\nstrategy(\"Volatility-Weighted ATR Momentum Strategy\", overlay=true, initial_capital=10000, default_qty_type=strategy.percent_of_equity, default_qty_value=10)\n\n// Inputs\natr_len = input.int(14, title=\"ATR Length\", minval=1)\natr_mult = input.float(1.5, title=\"ATR Multiplier\")\nvol_len = input.int(20, title=\"Volume SMA Length\")\nvol_wgt_len = input.int(7, title=\"Volatility Weight Length\")\n\n// Calculate ATR and normalize it by close price to get volatility ratio\natr = ta.atr(atr_len)\nvolatility_ratio = atr / close\n\n// Smooth volume and volatility ratio\nvol_sma = ta.sma(volume, vol_len)\nvolatility_wgt = ta.wma(volatility_ratio, vol_wgt_len)\n\n// Compute volume * volatility weight as a volatility-weighted volume measure\nvol_wgt_val = volume * volatility_wgt\n\n// Normalize volatility-weighted volume by its SMA for relative strength\nvol_wgt_sma = ta.sma(vol_wgt_val, vol_len)\nvol_wgt_rel = vol_wgt_val / vol_wgt_sma\n\n// Calculate RSI on close (momentum)\nrsi_len = 14\nrsi_val = ta.rsi(close, rsi_len)\n\n// Define dynamic threshold for volatility-weighted volume relative strength to confirm momentum\nvol_wgt_thresh = 1.1\n\n// Long Entry Condition:\n// - RSI crossing above 50 (starting positive momentum)\n// - volatility-weighted volume relative strength > threshold (volatility confirms volume surge)\n// - Close price above previous close (momentum in price)\n// - ATR breakout filter: price moves above previous high + ATR*multiplier (entry on volatility breakout)\nlong_cond = ta.crossover(rsi_val, 50) and vol_wgt_rel > vol_wgt_thresh and close > close[1] and close > high[1] + atr * atr_mult\n\n// Short Entry Condition (mirror opposite):\n// - RSI crossing below 50\n// - volatility-weighted volume relative strength > threshold\n// - Close price below previous close\n// - ATR breakout filter: price drops below previous low - ATR*multiplier\nshort_cond = ta.crossunder(rsi_val, 50) and vol_wgt_rel > vol_wgt_thresh and close < close[1] and close < low[1] - atr * atr_mult\n\n// Exit condition:\n// Exit long when RSI crosses below 50 or price closes below previous low - ATR*multiplier\nlong_exit = ta.crossunder(rsi_val, 50) or close < low[1] - atr * atr_mult\n\n// Exit short when RSI crosses above 50 or price closes above previous high + ATR*multiplier\nshort_exit = ta.crossover(rsi_val, 50) or close > high[1] + atr * atr_mult\n\n// Trade execution\nif (long_cond)\n    strategy.entry(\"Long\", strategy.long)\nif (long_exit)\n    strategy.close(\"Long\")\n\nif (short_cond)\n    strategy.entry(\"Short\", strategy.short)\nif (short_exit)\n    strategy.close(\"Short\")\n\n// Plot ATR breakout levels for visualization\nplot(high[1] + atr * atr_mult, color=color.new(color.green, 70), style=plot.style_linebr, title=\"Long Breakout Level\")\nplot(low[1] - atr * atr_mult, color=color.new(color.red, 70), style=plot.style_linebr, title=\"Short Breakout Level\")\n\n// Plot RSI and volatility-weighted volume relative strength for debugging\nplot(rsi_val, title=\"RSI\", color=color.orange)\nhline(50, color=color.gray)\nplot(vol_wgt_rel, title=\"Volatility-Weighted Volume Relative Strength\", color=color.purple)\nhline(vol_wgt_thresh, color=color.new(color.purple, 70))",
  "blueprint": {
    "nodes": [
      {
        "id": "md",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "minute",
          "interval": 1
        }
      },
      {
        "id": "atr14",
        "type": "atr",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div_volratio",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "wma_volratio",
        "type": "wma",
        "options": [
          {
            "id": "period",
            "value": 7,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul_vol_wgt",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_volwgt",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div_rel",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "rsi14",
        "type": "rsi",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_thresh",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1.1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_vol_rel",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_50",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 50,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "crossover_rsi50",
        "type": "crossover",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "prev_close_gt",
        "type": "previous_gt",
        "options": [
          {
            "id": "periods",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lag_high1",
        "type": "lag",
        "options": [
          {
            "id": "period",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_mult",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul_atr_mult",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "add_high_atr",
        "type": "add",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_close_break",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "all_long_cond",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "bool_false_short",
        "type": "bool_false",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [
          {
            "id": "closeIfIndecisive",
            "value": false,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "atr14",
          "handle": "result"
        },
        "target": {
          "id": "div_volratio",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "div_volratio",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div_volratio",
          "handle": "result"
        },
        "target": {
          "id": "wma_volratio",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "v"
        },
        "target": {
          "id": "mul_vol_wgt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "wma_volratio",
          "handle": "result"
        },
        "target": {
          "id": "mul_vol_wgt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul_vol_wgt",
          "handle": "result"
        },
        "target": {
          "id": "sma_volwgt",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "mul_vol_wgt",
          "handle": "result"
        },
        "target": {
          "id": "div_rel",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_volwgt",
          "handle": "result"
        },
        "target": {
          "id": "div_rel",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div_rel",
          "handle": "result"
        },
        "target": {
          "id": "gt_vol_rel",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_thresh",
          "handle": "result"
        },
        "target": {
          "id": "gt_vol_rel",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "rsi14",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "rsi14",
          "handle": "result"
        },
        "target": {
          "id": "crossover_rsi50",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_50",
          "handle": "result"
        },
        "target": {
          "id": "crossover_rsi50",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gt_vol_rel",
          "handle": "result"
        },
        "target": {
          "id": "all_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "crossover_rsi50",
          "handle": "result"
        },
        "target": {
          "id": "all_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "prev_close_gt",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "prev_close_gt",
          "handle": "result"
        },
        "target": {
          "id": "all_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "h"
        },
        "target": {
          "id": "lag_high1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "atr14",
          "handle": "result"
        },
        "target": {
          "id": "mul_atr_mult",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_mult",
          "handle": "result"
        },
        "target": {
          "id": "mul_atr_mult",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "lag_high1",
          "handle": "result"
        },
        "target": {
          "id": "add_high_atr",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul_atr_mult",
          "handle": "result"
        },
        "target": {
          "id": "add_high_atr",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "gt_close_break",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "add_high_atr",
          "handle": "result"
        },
        "target": {
          "id": "gt_close_break",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gt_close_break",
          "handle": "result"
        },
        "target": {
          "id": "all_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "all_long_cond",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "bool_false_short",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:05:31.253857",
  "tags": [
    "momentum",
    "ATR",
    "volatility",
    "trading strategy",
    "volume"
  ]
}