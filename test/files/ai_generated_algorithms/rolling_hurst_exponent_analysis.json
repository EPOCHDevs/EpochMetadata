{
  "id": "rolling_hurst_exponent_analysis",
  "name": "Rolling Hurst Exponent Analysis",
  "description": "This algorithm calculates the rolling Hurst exponent of a time series to identify the persistence or mean-reverting behavior of the data. By analyzing segments of the series over a specified window, it helps traders understand the underlying trends and volatility patterns.",
  "algorithm_type": "TechnicalPattern",
  "prompt": "import pandas as pd\nimport numpy as np\n\ndef rolling_hurst_exponent(ts, window):\n    exponents = np.full(len(ts), np.nan)\n    for i in range(window, len(ts)):\n        segment = ts.iloc[i-window:i]\n        lags = range(2, 20)\n        tau = [np.sqrt(np.std(np.subtract(segment.values[lag:], segment.values[:-lag]))) for lag in lags]\n        if np.any(np.array(tau) <= 0):\n            continue\n        poly = np.polyfit(np.log(lags), np.log(tau), 1)\n        exponents[i] = poly[0]*2.0\n    return exponents\n\ndef trading_strategy(data):\n    data = data.copy()\n    # Adaptive regime detection using rolling Hurst exponent (20 days)\n    data['hurst'] = rolling_hurst_exponent(data['close'], 20)\n    # Volatility filter: 10-day ATR\n    data['atr'] = data['high'].rolling(10).max() - data['low'].rolling(10).min()\n    data['atr_ma'] = data['atr'].rolling(5).mean()\n    # Volume surge detection\n    data['vol_ma'] = data['volume'].rolling(20).mean()\n    data['vol_surge'] = data['volume'] > 1.5 * data['vol_ma']\n    # Price escape velocity: current close - 2-day low normalized by ATR\n    data['escape_vel'] = (data['close'] - data['low'].rolling(2).min()) / (data['atr_ma'] + 1e-8)\n    # Entry conditions:\n    # 1. Regime is trending (hurst > 0.55)\n    # 2. Volatility is above its 5-day mean\n    # 3. Volume surge present\n    # 4. Price escape velocity > 1.5\n    data['signal'] = 0\n    long_cond = (\n        (data['hurst'] > 0.55) &\n        (data['atr'] > data['atr_ma']) &\n        (data['vol_surge']) &\n        (data['escape_vel'] > 1.5)\n    )\n    short_cond = (\n        (data['hurst'] < 0.45) &\n        (data['atr'] > data['atr_ma']) &\n        (data['vol_surge']) &\n        ((data['high'].rolling(2).max() - data['close']) / (data['atr_ma']+1e-8) > 1.5)\n    )\n    data.loc[long_cond, 'signal'] = 1\n    data.loc[short_cond, 'signal'] = -1\n    # Exit signals: ATR drops below its 5-day mean or Hurst returns to mean (0.5)\n    exit_long = (data['signal'].shift(1) == 1) & ((data['atr'] <= data['atr_ma']) | (data['hurst'] < 0.5))\n    exit_short = (data['signal'].shift(1) == -1) & ((data['atr'] <= data['atr_ma']) | (data['hurst'] > 0.5))\n    data.loc[exit_long, 'signal'] = 0\n    data.loc[exit_short, 'signal'] = 0\n    return data",
  "blueprint": {
    "nodes": [
      {
        "id": "md",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "hurst",
        "type": "rolling_hurst_exponent",
        "options": [
          {
            "id": "window",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "atr",
        "type": "atr",
        "options": [
          {
            "id": "period",
            "value": 10,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "sma_atr",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_vol",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_1_5",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul_vol",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_vol",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_0_55",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.55,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_hurst_high",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_0_45",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.45,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_hurst_low",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_atr",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "min_low2",
        "type": "min",
        "options": [
          {
            "id": "period",
            "value": 2,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sub_close_low",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div_escape",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_escape",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "max_high2",
        "type": "max",
        "options": [
          {
            "id": "period",
            "value": 2,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sub_high_close",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div_escape_short",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_escape_short",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "agg_long",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "agg_short",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lte_atr",
        "type": "lte",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_0_5",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_hurst_05",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_hurst_05",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "agg_exit_long",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "agg_exit_short",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "agg_close",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "hurst",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "atr",
          "handle": "result"
        },
        "target": {
          "id": "sma_atr",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "v"
        },
        "target": {
          "id": "sma_vol",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "sma_vol",
          "handle": "result"
        },
        "target": {
          "id": "mul_vol",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_1_5",
          "handle": "result"
        },
        "target": {
          "id": "mul_vol",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "v"
        },
        "target": {
          "id": "gt_vol",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul_vol",
          "handle": "result"
        },
        "target": {
          "id": "gt_vol",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "hurst",
          "handle": "result"
        },
        "target": {
          "id": "gt_hurst_high",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_0_55",
          "handle": "result"
        },
        "target": {
          "id": "gt_hurst_high",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "hurst",
          "handle": "result"
        },
        "target": {
          "id": "lt_hurst_low",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_0_45",
          "handle": "result"
        },
        "target": {
          "id": "lt_hurst_low",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "atr",
          "handle": "result"
        },
        "target": {
          "id": "gt_atr",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_atr",
          "handle": "result"
        },
        "target": {
          "id": "gt_atr",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "l"
        },
        "target": {
          "id": "min_low2",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "sub_close_low",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "min_low2",
          "handle": "result"
        },
        "target": {
          "id": "sub_close_low",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "sub_close_low",
          "handle": "result"
        },
        "target": {
          "id": "div_escape",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_atr",
          "handle": "result"
        },
        "target": {
          "id": "div_escape",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div_escape",
          "handle": "result"
        },
        "target": {
          "id": "gt_escape",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_1_5",
          "handle": "result"
        },
        "target": {
          "id": "gt_escape",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "h"
        },
        "target": {
          "id": "max_high2",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "max_high2",
          "handle": "result"
        },
        "target": {
          "id": "sub_high_close",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "md",
          "handle": "c"
        },
        "target": {
          "id": "sub_high_close",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "sub_high_close",
          "handle": "result"
        },
        "target": {
          "id": "div_escape_short",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_atr",
          "handle": "result"
        },
        "target": {
          "id": "div_escape_short",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div_escape_short",
          "handle": "result"
        },
        "target": {
          "id": "gt_escape_short",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_1_5",
          "handle": "result"
        },
        "target": {
          "id": "gt_escape_short",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gt_hurst_high",
          "handle": "result"
        },
        "target": {
          "id": "agg_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_atr",
          "handle": "result"
        },
        "target": {
          "id": "agg_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_vol",
          "handle": "result"
        },
        "target": {
          "id": "agg_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_escape",
          "handle": "result"
        },
        "target": {
          "id": "agg_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_hurst_low",
          "handle": "result"
        },
        "target": {
          "id": "agg_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_atr",
          "handle": "result"
        },
        "target": {
          "id": "agg_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_vol",
          "handle": "result"
        },
        "target": {
          "id": "agg_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_escape_short",
          "handle": "result"
        },
        "target": {
          "id": "agg_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "atr",
          "handle": "result"
        },
        "target": {
          "id": "lte_atr",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_atr",
          "handle": "result"
        },
        "target": {
          "id": "lte_atr",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "hurst",
          "handle": "result"
        },
        "target": {
          "id": "lt_hurst_05",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_0_5",
          "handle": "result"
        },
        "target": {
          "id": "lt_hurst_05",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "hurst",
          "handle": "result"
        },
        "target": {
          "id": "gt_hurst_05",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_0_5",
          "handle": "result"
        },
        "target": {
          "id": "gt_hurst_05",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "lte_atr",
          "handle": "result"
        },
        "target": {
          "id": "agg_exit_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_hurst_05",
          "handle": "result"
        },
        "target": {
          "id": "agg_exit_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lte_atr",
          "handle": "result"
        },
        "target": {
          "id": "agg_exit_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_hurst_05",
          "handle": "result"
        },
        "target": {
          "id": "agg_exit_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "agg_exit_long",
          "handle": "result"
        },
        "target": {
          "id": "agg_close",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "agg_exit_short",
          "handle": "result"
        },
        "target": {
          "id": "agg_close",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "agg_long",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "agg_short",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "agg_close",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:28:47.822034",
  "tags": [
    "Hurst Exponent",
    "Technical Analysis",
    "Volatility",
    "Time Series",
    "Rolling Window"
  ]
}