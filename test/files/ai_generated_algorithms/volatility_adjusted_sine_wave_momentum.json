{
  "id": "volatility_adjusted_sine_wave_momentum",
  "name": "Volatility-Adjusted Sine Wave Momentum",
  "description": "This strategy utilizes a sine wave approach to momentum trading, adjusting for market volatility using the Average True Range (ATR). By incorporating volatility thresholds, it aims to optimize entry and exit points for trades based on price movements.",
  "algorithm_type": "Momentum",
  "prompt": "//@version=5\nstrategy(\"Volatility-Adjusted Sine Wave Momentum Strategy\", overlay=true, initial_capital=10000, default_qty_type=strategy.percent_of_equity, default_qty_value=10)\n\n// Inputs\nlength = input.int(21, \"Sine Wave Length\", minval=5)\nvol_length = input.int(14, \"Volatility Length\")\nvol_threshold = input.float(0.5, \"Volatility Threshold (ATR %)\", step=0.1)\n\n// Calculate Median Price\nmedianPrice = ta.median(high, low)\n\n// Calculate Mesa Sine Wave (built-in)\nsineWave = ta.mesa(medianPrice, length)\n\n// Calculate the slope of sine wave (momentum)\nslope = sineWave - ta.nz(sineWave[1])\n\n// Calculate ATR as volatility measure\natr = ta.atr(vol_length)\n\n// Normalize ATR as ratio to close price\nvolatilityRatio = atr / close\n\n// Define volatility condition (only trade when volatility is moderate-to-high)\nvolatilityCondition = volatilityRatio > vol_threshold / 100\n\n// Entry conditions:\n// Long: sineWave is rising (slope > 0) and crosses above zero line, with sufficient volatility\nlongCondition = ta.crossover(sineWave, 0) and slope > 0 and volatilityCondition\n\n// Short: sineWave is falling (slope < 0) and crosses below zero line, with sufficient volatility\nshortCondition = ta.crossunder(sineWave, 0) and slope < 0 and volatilityCondition\n\n// Exit conditions: opposite signals or volatility drops below threshold\nexitLong = ta.crossunder(sineWave, 0) or volatilityRatio <= vol_threshold / 100\nexitShort = ta.crossover(sineWave, 0) or volatilityRatio <= vol_threshold / 100\n\n// Execute trades\nif (longCondition)\n    strategy.entry(\"Long\", strategy.long)\nif (shortCondition)\n    strategy.entry(\"Short\", strategy.short)\nif (exitLong)\n    strategy.close(\"Long\")\nif (exitShort)\n    strategy.close(\"Short\")\n\n// Plot sine wave and zero line\nplot(sineWave, color=color.orange, title=\"Mesa Sine Wave\", linewidth=2)\nhline(0, color=color.gray, title=\"Zero Line\")\n\n// Plot volatility ratio as a separate indicator on price pane (scaled)\nplot(volatilityRatio * 100, color=color.blue, title=\"Volatility Ratio (%)\", linewidth=1)\nhline(vol_threshold, color=color.red, title=\"Volatility Threshold\", linestyle=hline.style_dotted)",
  "blueprint": {
    "nodes": [
      {
        "id": "n1_src",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "n2_med",
        "type": "medprice",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "n3_msw",
        "type": "msw",
        "options": [
          {
            "id": "period",
            "value": 21,
            "name": "Sine Wave Length",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n4_lag",
        "type": "lag",
        "options": [
          {
            "id": "period",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n5_slope",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n6_zero",
        "type": "zero",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n7_cross_up",
        "type": "crossover",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n8_cross_down",
        "type": "crossover",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n9_slope_gt",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n10_slope_lt",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n11_atr",
        "type": "atr",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "Vol Length",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "n12_vol_ratio",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n13_threshold",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.005,
            "name": "Vol Threshold Ratio",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n14_vol_ok",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n15_vol_low",
        "type": "lte",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n16_long_cond",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n17_short_cond",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n18_exit_long",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n19_exit_short",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n20_exit_any",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "n21_exec",
        "type": "trade_signal_executor",
        "options": [
          {
            "id": "closeIfIndecisive",
            "value": false,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "n2_med",
          "handle": "result"
        },
        "target": {
          "id": "n3_msw",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n3_msw",
          "handle": "msw_sine"
        },
        "target": {
          "id": "n4_lag",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n3_msw",
          "handle": "msw_sine"
        },
        "target": {
          "id": "n5_slope",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n4_lag",
          "handle": "result"
        },
        "target": {
          "id": "n5_slope",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n3_msw",
          "handle": "msw_sine"
        },
        "target": {
          "id": "n7_cross_up",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n6_zero",
          "handle": "result"
        },
        "target": {
          "id": "n7_cross_up",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n6_zero",
          "handle": "result"
        },
        "target": {
          "id": "n8_cross_down",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n3_msw",
          "handle": "msw_sine"
        },
        "target": {
          "id": "n8_cross_down",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n5_slope",
          "handle": "result"
        },
        "target": {
          "id": "n9_slope_gt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n6_zero",
          "handle": "result"
        },
        "target": {
          "id": "n9_slope_gt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n5_slope",
          "handle": "result"
        },
        "target": {
          "id": "n10_slope_lt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n6_zero",
          "handle": "result"
        },
        "target": {
          "id": "n10_slope_lt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n11_atr",
          "handle": "result"
        },
        "target": {
          "id": "n12_vol_ratio",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n1_src",
          "handle": "c"
        },
        "target": {
          "id": "n12_vol_ratio",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n12_vol_ratio",
          "handle": "result"
        },
        "target": {
          "id": "n14_vol_ok",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n13_threshold",
          "handle": "result"
        },
        "target": {
          "id": "n14_vol_ok",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n12_vol_ratio",
          "handle": "result"
        },
        "target": {
          "id": "n15_vol_low",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "n13_threshold",
          "handle": "result"
        },
        "target": {
          "id": "n15_vol_low",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "n7_cross_up",
          "handle": "result"
        },
        "target": {
          "id": "n16_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n9_slope_gt",
          "handle": "result"
        },
        "target": {
          "id": "n16_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n14_vol_ok",
          "handle": "result"
        },
        "target": {
          "id": "n16_long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n8_cross_down",
          "handle": "result"
        },
        "target": {
          "id": "n17_short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n10_slope_lt",
          "handle": "result"
        },
        "target": {
          "id": "n17_short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n14_vol_ok",
          "handle": "result"
        },
        "target": {
          "id": "n17_short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n8_cross_down",
          "handle": "result"
        },
        "target": {
          "id": "n18_exit_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n15_vol_low",
          "handle": "result"
        },
        "target": {
          "id": "n18_exit_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n7_cross_up",
          "handle": "result"
        },
        "target": {
          "id": "n19_exit_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n15_vol_low",
          "handle": "result"
        },
        "target": {
          "id": "n19_exit_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n18_exit_long",
          "handle": "result"
        },
        "target": {
          "id": "n20_exit_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n19_exit_short",
          "handle": "result"
        },
        "target": {
          "id": "n20_exit_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "n16_long_cond",
          "handle": "result"
        },
        "target": {
          "id": "n21_exec",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "n17_short_cond",
          "handle": "result"
        },
        "target": {
          "id": "n21_exec",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "n20_exit_any",
          "handle": "result"
        },
        "target": {
          "id": "n21_exec",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:07:35.281088",
  "tags": [
    "momentum",
    "sine_wave",
    "volatility",
    "ATR",
    "trading_strategy"
  ]
}