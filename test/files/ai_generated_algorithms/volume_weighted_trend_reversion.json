{
  "id": "momentum_volume_weighted_trend_reversion",
  "name": "Volume-Weighted Trend Reversion Strategy",
  "description": "This strategy utilizes a volume-weighted moving average (VWMA) to identify trend strength and potential reversals. By combining fast and slow exponential moving averages (EMA) with an ADX filter, it aims to capitalize on momentum shifts in the market.",
  "algorithm_type": "Momentum",
  "prompt": "//@version=5\nstrategy(\"Volume-Weighted Trend Strength Reversion\", overlay=true, initial_capital=10000, default_qty_type=strategy.percent_of_equity, default_qty_value=10)\n\n// Inputs\nlength_vwma = input.int(20, \"VWMA Length\", minval=1)\nlength_ema_fast = input.int(8, \"EMA Fast Length\", minval=1)\nlength_ema_slow = input.int(34, \"EMA Slow Length\", minval=1)\nlength_adx = input.int(14, \"ADX Length\", minval=1)\nadx_threshold = input.float(25, \"ADX Threshold\", step=0.1)\nrsi_length = input.int(14, \"RSI Length\", minval=1)\nrsi_overbought = input.int(70, \"RSI Overbought\")\nrsi_oversold = input.int(30, \"RSI Oversold\")\n\n// Calculate VWMA (Volume Weighted Moving Average)\nvwma = ta.sum(close * volume, length_vwma) / ta.sum(volume, length_vwma)\n\n// Calculate EMAs\nema_fast = ta.ema(close, length_ema_fast)\nema_slow = ta.ema(close, length_ema_slow)\n\n// ADX for trend strength\nadx_val = ta.adx(length_adx)\n\n// RSI for momentum extremes\nrsi_val = ta.rsi(close, rsi_length)\n\n// Custom Trend Strength Index (TSI)\n// TSI here = normalized distance between VWMA and EMA slow, weighted by ADX strength\ntsi_raw = math.abs(vwma - ema_slow)\ntsi = adx_val > 0 ? tsi_raw / ema_slow : 0.0\n\n// Entry conditions\n// Long Entry:\n// 1) Price (close) crossed below VWMA (short-term volume weighted mean) - indicates short term dip\n// 2) TSI is above mid-level threshold (indicating strong trend presence)\n// 3) RSI is in oversold zone (momentum exhausted low)\n// 4) ADX above threshold to confirm trend strength\nlong_enter = ta.crossunder(close, vwma) and tsi > 0.005 and rsi_val < rsi_oversold and adx_val > adx_threshold\n\n// Short Entry:\n// 1) Price crossed above VWMA - indicates short term pullback in downtrend\n// 2) TSI above threshold (strong trend)\n// 3) RSI above overbought (momentum exhausted high)\n// 4) ADX above threshold\nshort_enter = ta.crossover(close, vwma) and tsi > 0.005 and rsi_val > rsi_overbought and adx_val > adx_threshold\n\n// Exit rules:\n// Exit longs when close crosses above EMA fast (means momentum has reverted)\n// Exit shorts when close crosses below EMA fast\nlong_exit = ta.crossover(close, ema_fast)\nshort_exit = ta.crossunder(close, ema_fast)\n\n// Strategy entries and exits\nif (long_enter)\n    strategy.entry(\"Long\", strategy.long)\nif (short_enter)\n    strategy.entry(\"Short\", strategy.short)\nif (long_exit)\n    strategy.close(\"Long\")\nif (short_exit)\n    strategy.close(\"Short\")\n\n// Plotting\nplot(vwma, color=color.orange, title=\"VWMA\")\nplot(ema_fast, color=color.green, title=\"EMA Fast\")\nplot(ema_slow, color=color.red, title=\"EMA Slow\")\n\nhline(adx_threshold, \"ADX Threshold\", color=color.gray, linestyle=hline.style_dotted)\nplot(adx_val, color=color.blue, title=\"ADX\")\n\nplot(rsi_val, title=\"RSI\", color=color.purple)\nhline(rsi_overbought, \"RSI Overbought\", color=color.red, linestyle=hline.style_dashed)\nhline(rsi_oversold, \"RSI Oversold\", color=color.green, linestyle=hline.style_dashed)\n\nbgcolor(long_enter ? color.new(color.green, 90) : na)\nbgcolor(short_enter ? color.new(color.red, 90) : na)",
  "blueprint": {
    "nodes": [
      {
        "id": "src",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "vwma_node",
        "type": "vwma",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "ema_fast",
        "type": "ema",
        "options": [
          {
            "id": "period",
            "value": 8,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "ema_slow",
        "type": "ema",
        "options": [
          {
            "id": "period",
            "value": 34,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "adx_node",
        "type": "adx",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "rsi_node",
        "type": "rsi",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sub_diff",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "abs_diff",
        "type": "abs",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div_norm",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_tsi_thr",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.005,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_tsi",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_adx_thr",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 25,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_adx",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_rsi_ob",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 70,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_rsi_ob",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_rsi_os",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 30,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_rsi_os",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_price_below",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_price_above",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "long_cond",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "short_cond",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_close_above_ema_fast",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_close_below_ema_fast",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "exit_any",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [
          {
            "id": "closeIfIndecisive",
            "value": false,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "ema_fast",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "ema_slow",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "rsi_node",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "vwma_node",
          "handle": "result"
        },
        "target": {
          "id": "sub_diff",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "ema_slow",
          "handle": "result"
        },
        "target": {
          "id": "sub_diff",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "sub_diff",
          "handle": "result"
        },
        "target": {
          "id": "abs_diff",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "abs_diff",
          "handle": "result"
        },
        "target": {
          "id": "div_norm",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "ema_slow",
          "handle": "result"
        },
        "target": {
          "id": "div_norm",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div_norm",
          "handle": "result"
        },
        "target": {
          "id": "gt_tsi",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_tsi_thr",
          "handle": "result"
        },
        "target": {
          "id": "gt_tsi",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adx_node",
          "handle": "result"
        },
        "target": {
          "id": "gt_adx",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_adx_thr",
          "handle": "result"
        },
        "target": {
          "id": "gt_adx",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "rsi_node",
          "handle": "result"
        },
        "target": {
          "id": "gt_rsi_ob",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_rsi_ob",
          "handle": "result"
        },
        "target": {
          "id": "gt_rsi_ob",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "rsi_node",
          "handle": "result"
        },
        "target": {
          "id": "lt_rsi_os",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_rsi_os",
          "handle": "result"
        },
        "target": {
          "id": "lt_rsi_os",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "lt_price_below",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "vwma_node",
          "handle": "result"
        },
        "target": {
          "id": "lt_price_below",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "gt_price_above",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "vwma_node",
          "handle": "result"
        },
        "target": {
          "id": "gt_price_above",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "lt_price_below",
          "handle": "result"
        },
        "target": {
          "id": "long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_tsi",
          "handle": "result"
        },
        "target": {
          "id": "long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_rsi_os",
          "handle": "result"
        },
        "target": {
          "id": "long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_adx",
          "handle": "result"
        },
        "target": {
          "id": "long_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_price_above",
          "handle": "result"
        },
        "target": {
          "id": "short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_tsi",
          "handle": "result"
        },
        "target": {
          "id": "short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_rsi_ob",
          "handle": "result"
        },
        "target": {
          "id": "short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_adx",
          "handle": "result"
        },
        "target": {
          "id": "short_cond",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "gt_close_above_ema_fast",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "ema_fast",
          "handle": "result"
        },
        "target": {
          "id": "gt_close_above_ema_fast",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "lt_close_below_ema_fast",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "ema_fast",
          "handle": "result"
        },
        "target": {
          "id": "lt_close_below_ema_fast",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gt_close_above_ema_fast",
          "handle": "result"
        },
        "target": {
          "id": "exit_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_close_below_ema_fast",
          "handle": "result"
        },
        "target": {
          "id": "exit_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "long_cond",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "short_cond",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "exit_any",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:17:20.779842",
  "tags": [
    "momentum",
    "trend",
    "VWMA",
    "EMA",
    "ADX"
  ]
}