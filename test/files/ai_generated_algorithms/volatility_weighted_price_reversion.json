{
  "id": "algorithm-001",
  "name": "Volatility-Weighted Price Reversion",
  "description": "This strategy utilizes a volatility-weighted approach to identify typical price reversions based on moving averages of price and volume. By analyzing the typical price over a specified length and adjusting for volatility, it aims to capitalize on price corrections in the market.",
  "algorithm_type": "TechnicalPattern",
  "prompt": "//@version=5\nstrategy(\"Volatility-Weighted Typical Price Reversion\", overlay=true, default_qty_type=strategy.percent_of_equity, default_qty_value=10)\n\n// Input parameters\ntp_length = input.int(14, title=\"Typical Price MA Length\")\nvol_length = input.int(20, title=\"Volume MA Length\")\nvol_wgt_length = input.int(10, title=\"Volatility Weight Length\")\nthreshold = input.float(0.005, title=\"Reversion Threshold (Price Change %)\", step=0.001)\n\n// Typical Price and its moving average\ntyp_price = (high + low + close) / 3\ntp_ma = ta.sma(typ_price, tp_length)\n\n// Volume weighted volatility calculation\nvol_ma = ta.sma(volume, vol_length)\nprice_ret = math.abs(typ_price - typ_price[1]) / typ_price[1]\nvolatility = ta.sma(price_ret * volume / vol_ma, vol_wgt_length)  // volatility weighted by volume relative to avg vol\n\n// Dynamic threshold adjusted by volatility\nadj_threshold = threshold * (1 + volatility * 3)\n\n// Price deviation from MA normalized by typical price\ndev = (typ_price - tp_ma) / tp_ma\n\n// Entry conditions: Revert to mean when deviation exceeds dynamic threshold\nlong_condition = dev < -adj_threshold\nshort_condition = dev > adj_threshold\n\n// Exits: Close position when price returns inside threshold band\nlong_exit = dev >= -adj_threshold / 2\nshort_exit = dev <= adj_threshold / 2\n\n// Trade execution\nif (long_condition)\n    strategy.entry(\"Long\", strategy.long)\nif (long_exit and strategy.position_size > 0)\n    strategy.close(\"Long\")\n\nif (short_condition)\n    strategy.entry(\"Short\", strategy.short)\nif (short_exit and strategy.position_size < 0)\n    strategy.close(\"Short\")\n\n// Plot Typical Price MA for visualization\nplot(tp_ma, color=color.orange, title=\"Typical Price MA\")\nplot(typ_price, color=color.blue, title=\"Typical Price\")\nhline(0, \"Zero Line\", color=color.gray)",
  "blueprint": {
    "nodes": [
      {
        "id": "mds",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "minute",
          "interval": 1
        }
      },
      {
        "id": "typ",
        "type": "typprice",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "minute",
          "interval": 1
        }
      },
      {
        "id": "sma_tp",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "TP MA Length",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "roc1",
        "type": "roc",
        "options": [
          {
            "id": "period",
            "value": 1,
            "name": "ROC Period",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "abs1",
        "type": "abs",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_vol_ma",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "Volume MA Length",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul1",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div1",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_vol",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 10,
            "name": "Volatility Weight Length",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const3",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 3,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul2",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const1",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "add1",
        "type": "add",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_thr",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.005,
            "name": "Base Threshold",
            "isExposed": true
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul3",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_neg1",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": -1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul_neg",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_nh",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": -0.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul4",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const_ph",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "mul5",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sub1",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "div2",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt1",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt1",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gte1",
        "type": "gte",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lte1",
        "type": "lte",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "any1",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [
          {
            "id": "closeIfIndecisive",
            "value": false,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "mds",
          "handle": "v"
        },
        "target": {
          "id": "sma_vol_ma",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "typ",
          "handle": "result"
        },
        "target": {
          "id": "sma_tp",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "typ",
          "handle": "result"
        },
        "target": {
          "id": "roc1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "roc1",
          "handle": "result"
        },
        "target": {
          "id": "abs1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "abs1",
          "handle": "result"
        },
        "target": {
          "id": "mul1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mds",
          "handle": "v"
        },
        "target": {
          "id": "mul1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul1",
          "handle": "result"
        },
        "target": {
          "id": "div1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_vol_ma",
          "handle": "result"
        },
        "target": {
          "id": "div1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div1",
          "handle": "result"
        },
        "target": {
          "id": "sma_vol",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "sma_vol",
          "handle": "result"
        },
        "target": {
          "id": "mul2",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const3",
          "handle": "result"
        },
        "target": {
          "id": "mul2",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul2",
          "handle": "result"
        },
        "target": {
          "id": "add1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const1",
          "handle": "result"
        },
        "target": {
          "id": "add1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "const_thr",
          "handle": "result"
        },
        "target": {
          "id": "mul3",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "add1",
          "handle": "result"
        },
        "target": {
          "id": "mul3",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul3",
          "handle": "result"
        },
        "target": {
          "id": "mul_neg",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_neg1",
          "handle": "result"
        },
        "target": {
          "id": "mul_neg",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul3",
          "handle": "result"
        },
        "target": {
          "id": "mul4",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_nh",
          "handle": "result"
        },
        "target": {
          "id": "mul4",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "mul3",
          "handle": "result"
        },
        "target": {
          "id": "mul5",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "const_ph",
          "handle": "result"
        },
        "target": {
          "id": "mul5",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "typ",
          "handle": "result"
        },
        "target": {
          "id": "sub1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_tp",
          "handle": "result"
        },
        "target": {
          "id": "sub1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "sub1",
          "handle": "result"
        },
        "target": {
          "id": "div2",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_tp",
          "handle": "result"
        },
        "target": {
          "id": "div2",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div2",
          "handle": "result"
        },
        "target": {
          "id": "lt1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul_neg",
          "handle": "result"
        },
        "target": {
          "id": "lt1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div2",
          "handle": "result"
        },
        "target": {
          "id": "gt1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul3",
          "handle": "result"
        },
        "target": {
          "id": "gt1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div2",
          "handle": "result"
        },
        "target": {
          "id": "gte1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul4",
          "handle": "result"
        },
        "target": {
          "id": "gte1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "div2",
          "handle": "result"
        },
        "target": {
          "id": "lte1",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mul5",
          "handle": "result"
        },
        "target": {
          "id": "lte1",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gte1",
          "handle": "result"
        },
        "target": {
          "id": "any1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lte1",
          "handle": "result"
        },
        "target": {
          "id": "any1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt1",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "gt1",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "any1",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:52:49.605643",
  "tags": [
    "technical",
    "reversion",
    "volatility",
    "strategy",
    "price"
  ]
}