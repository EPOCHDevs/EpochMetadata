{
  "id": "adaptive_hurst_z_score_reversal",
  "name": "Adaptive Hurst Z-Score Reversal",
  "description": "This strategy utilizes the Hurst exponent to assess market trends and the Z-score for identifying potential reversals. It aims to capitalize on price movements by entering trades when the Z-score exceeds a defined threshold, indicating overbought or oversold conditions.",
  "algorithm_type": "TechnicalPattern",
  "prompt": "//@version=5\nstrategy(\"Adaptive Hurst-Z Score Reversal\", overlay=true, initial_capital=100000, default_qty_type=strategy.percent_of_equity, default_qty_value=10)\n\n// Inputs\nhurst_length = input.int(64, title=\"Hurst Exponent Length\", minval=20)\nzscore_length = input.int(21, title=\"Z-Score Length\", minval=10)\nthreshold_entry = input.float(1.5, title=\"Z-Score Entry Threshold\", step=0.1)\nthreshold_exit = input.float(0.5, title=\"Z-Score Exit Threshold\", step=0.1)\n\n// Calculate Hurst Exponent (rolling)\ncalc_hurst(src, length) =>\n    var float[] RS = array.new_float()\n    maxsec = length\n    // resample into chunks\n    step = 1\n    n = maxsec\n    devs = ta.stdev(src, n)\n    maxv = ta.highest(src, n)\n    minv = ta.lowest(src, n)\n    R = maxv - minv\n    S = devs\n    RSratio = R / S\n    hurst = math.log(RSratio) / math.log(n)\n    hurst\n\nhurst = calc_hurst(close, hurst_length)\n\n// Calculate rolling Z-Score of close price returns adjusted by Hurst exponent to normalize memory effect\nrets = math.log(close / close[1])\nrets_ma = ta.sma(rets, zscore_length)\nrets_std = ta.stdev(rets, zscore_length)\nzscore = rets_std != 0 ? (rets - rets_ma) / rets_std : 0\n\n// Adjust z-score by hurst (to dampen signal when persistent trend is detected)\nadj_zscore = zscore * math.sqrt(2 - hurst)\n\n// Signals for reversal based on adjusted Z-Score extremes\nlong_entry  = adj_zscore < -threshold_entry\nlong_exit   = adj_zscore > -threshold_exit\nshort_entry = adj_zscore > threshold_entry\nshort_exit  = adj_zscore < threshold_exit\n\n// Manage entries and exits\nif (long_entry)\n    strategy.entry(\"Long\", strategy.long)\nif (long_exit)\n    strategy.close(\"Long\")\nif (short_entry)\n    strategy.entry(\"Short\", strategy.short)\nif (short_exit)\n    strategy.close(\"Short\")\n\n// Plot\nplot(adj_zscore, title=\"Adj. Z-Score\", color=color.new(color.orange,0))\nhline( threshold_entry, \"Entry Threshold+\", color=color.red, linestyle=hline.style_dotted)\nhline(-threshold_entry, \"Entry Threshold-\", color=color.green, linestyle=hline.style_dotted)\nhline(0, \"Zero\", color=color.gray, linestyle=hline.style_solid)\nplot(hurst, title=\"Hurst Exponent\", color=color.blue)",
  "blueprint": {
    "nodes": [
      {
        "id": "mds",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "ln_close",
        "type": "ln",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lag1",
        "type": "lag",
        "options": [
          {
            "id": "period",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "returns_sub",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_returns",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 21,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "returns_minus_mean",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "stddev_returns",
        "type": "stddev",
        "options": [
          {
            "id": "period",
            "value": 21,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "zscore_div",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "hurst_node",
        "type": "rolling_hurst_exponent",
        "options": [
          {
            "id": "window",
            "value": 64,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "const2",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 2,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "two_minus_hurst",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sqrt_node",
        "type": "sqrt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "adj_zscore_mul",
        "type": "mul",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "neg_entry",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": -1.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "neg_exit",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": -0.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "pos_entry",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "pos_exit",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0.5,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "long_entry_lt",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "long_exit_gt",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "short_entry_gt",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "short_exit_lt",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "combine_close",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "mds",
          "handle": "c"
        },
        "target": {
          "id": "ln_close",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "ln_close",
          "handle": "result"
        },
        "target": {
          "id": "returns_sub",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "mds",
          "handle": "c"
        },
        "target": {
          "id": "lag1",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lag1",
          "handle": "result"
        },
        "target": {
          "id": "returns_sub",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "returns_sub",
          "handle": "result"
        },
        "target": {
          "id": "sma_returns",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "returns_sub",
          "handle": "result"
        },
        "target": {
          "id": "returns_minus_mean",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_returns",
          "handle": "result"
        },
        "target": {
          "id": "returns_minus_mean",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "returns_minus_mean",
          "handle": "result"
        },
        "target": {
          "id": "zscore_div",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "stddev_returns",
          "handle": "result"
        },
        "target": {
          "id": "zscore_div",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "returns_sub",
          "handle": "result"
        },
        "target": {
          "id": "stddev_returns",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "mds",
          "handle": "c"
        },
        "target": {
          "id": "hurst_node",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "const2",
          "handle": "result"
        },
        "target": {
          "id": "two_minus_hurst",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "hurst_node",
          "handle": "result"
        },
        "target": {
          "id": "two_minus_hurst",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "two_minus_hurst",
          "handle": "result"
        },
        "target": {
          "id": "sqrt_node",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "zscore_div",
          "handle": "result"
        },
        "target": {
          "id": "adj_zscore_mul",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sqrt_node",
          "handle": "result"
        },
        "target": {
          "id": "adj_zscore_mul",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adj_zscore_mul",
          "handle": "result"
        },
        "target": {
          "id": "long_entry_lt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "neg_entry",
          "handle": "result"
        },
        "target": {
          "id": "long_entry_lt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adj_zscore_mul",
          "handle": "result"
        },
        "target": {
          "id": "long_exit_gt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "neg_exit",
          "handle": "result"
        },
        "target": {
          "id": "long_exit_gt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adj_zscore_mul",
          "handle": "result"
        },
        "target": {
          "id": "short_entry_gt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "pos_entry",
          "handle": "result"
        },
        "target": {
          "id": "short_entry_gt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adj_zscore_mul",
          "handle": "result"
        },
        "target": {
          "id": "short_exit_lt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "pos_exit",
          "handle": "result"
        },
        "target": {
          "id": "short_exit_lt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "long_exit_gt",
          "handle": "result"
        },
        "target": {
          "id": "combine_close",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "short_exit_lt",
          "handle": "result"
        },
        "target": {
          "id": "combine_close",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "long_entry_lt",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "short_entry_gt",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "combine_close",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:48:55.789154",
  "tags": [
    "technical",
    "reversal",
    "hurst",
    "z-score",
    "strategy"
  ]
}