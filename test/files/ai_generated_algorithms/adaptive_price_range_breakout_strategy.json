{
  "id": "unique-id-001",
  "name": "Adaptive Price Range Breakout Strategy",
  "description": "The Adaptive Price Range Expansion (APRE) Strategy identifies breakout opportunities by detecting expanding price ranges alongside volume surges. It employs an adaptive average true range (ATR) and volume z-score to signal long entries when the price breaks above the expanding range with strong momentum.",
  "algorithm_type": "TechnicalPattern",
  "prompt": "import pandas as pd\nimport numpy as np\nimport talib\n\ndef trading_strategy(data):\n    \"\"\"\n    Adaptive Price Range Expansion (APRE) Strategy:\n    This strategy detects expanding price ranges combined with a volume surge\n    to identify breakout opportunity zones.\n    It uses an adaptive average true range (ATR) and volume z-score,\n    entering long when price breaks above expanding range with strong volume,\n    and short when breaking below expanding range with strong volume.\n    \"\"\"\n    high = data['high']\n    low = data['low']\n    close = data['close']\n    volume = data['volume']\n\n    # Calculate ATR (14)\n    atr = talib.ATR(high, low, close, timeperiod=14)\n    data['atr'] = atr\n\n    # Adaptive Range Expansion (ARE) indicator to detect expanding volatility\n    # Calculate rolling max and min of ATR over 10 and 20 periods to detect expansions\n    atr_max_10 = atr.rolling(10).max()\n    atr_min_20 = atr.rolling(20).min()\n\n    data['are_ratio'] = atr_max_10 / (atr_min_20 + 1e-9)  # avoid div0\n\n    # Volume z-score (standardize volume over 20 periods)\n    vol_mean = volume.rolling(20).mean()\n    vol_std = volume.rolling(20).std()\n    data['vol_zscore'] = (volume - vol_mean) / (vol_std + 1e-9)\n\n    # Define adaptive price range: rolling max high and min low over 20 periods\n    rolling_high = high.rolling(20).max()\n    rolling_low = low.rolling(20).min()\n\n    data['rolling_high'] = rolling_high\n    data['rolling_low'] = rolling_low\n\n    # Entry conditions:\n    # Long Entry: close breaks above rolling high AND ARE ratio > 1.2 (expanding range) AND volume zscore > 1\n    data['long_entry'] = (close > rolling_high.shift(1)) & (data['are_ratio'] > 1.2) & (data['vol_zscore'] > 1)\n\n    # Short Entry: close breaks below rolling low AND ARE ratio > 1.2 AND volume zscore > 1\n    data['short_entry'] = (close < rolling_low.shift(1)) & (data['are_ratio'] > 1.2) & (data['vol_zscore'] > 1)\n\n    # Exit conditions:\n    # Simple exit: price closes back within the range (between rolling low and rolling high)\n    data['long_exit'] = (close < rolling_high)\n    data['short_exit'] = (close > rolling_low)\n\n    # Initialize position column\n    data['position'] = 0\n\n    # Iterate to generate position signal\n    position = 0\n    for i in range(1, len(data)):\n        if position == 0:\n            if data['long_entry'].iloc[i]:\n                position = 1\n            elif data['short_entry'].iloc[i]:\n                position = -1\n        elif position == 1:\n            if data['long_exit'].iloc[i]:\n                position = 0\n        elif position == -1:\n            if data['short_exit'].iloc[i]:\n                position = 0\n\n        data.at[data.index[i], 'position'] = position\n\n    # Final signal to trade: 1 for long, -1 for short, 0 for no position\n    data['signal'] = data['position']\n\n    return data[['open', 'high', 'low', 'close', 'volume', 'atr', 'are_ratio', 'vol_zscore', 'rolling_high', 'rolling_low', 'signal']]",
  "blueprint": {
    "nodes": [
      {
        "id": "src",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "minute",
          "interval": 1
        }
      },
      {
        "id": "atr14",
        "type": "atr",
        "options": [
          {
            "id": "period",
            "value": 14,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "minute",
          "interval": 1
        }
      },
      {
        "id": "atr_max10",
        "type": "max",
        "options": [
          {
            "id": "period",
            "value": 10,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "atr_min20",
        "type": "min",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "are_div",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_1p2",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1.2,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "are_gt",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "sma_vol20",
        "type": "sma",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "std_vol20",
        "type": "stddev",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "vol_diff",
        "type": "sub",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "vol_z",
        "type": "div",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num_1",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 1,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "vol_gt",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "high20",
        "type": "max",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "low20",
        "type": "min",
        "options": [
          {
            "id": "period",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "close_gt_high",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "close_lt_low",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "long_entry",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "short_entry",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "long_exit",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "short_exit",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "close_any",
        "type": "agg_any_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor",
        "type": "trade_signal_executor",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "atr14",
          "handle": "result"
        },
        "target": {
          "id": "atr_max10",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "atr14",
          "handle": "result"
        },
        "target": {
          "id": "atr_min20",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "atr_max10",
          "handle": "result"
        },
        "target": {
          "id": "are_div",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "atr_min20",
          "handle": "result"
        },
        "target": {
          "id": "are_div",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "are_div",
          "handle": "result"
        },
        "target": {
          "id": "are_gt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_1p2",
          "handle": "result"
        },
        "target": {
          "id": "are_gt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "v"
        },
        "target": {
          "id": "sma_vol20",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "v"
        },
        "target": {
          "id": "std_vol20",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "v"
        },
        "target": {
          "id": "vol_diff",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "sma_vol20",
          "handle": "result"
        },
        "target": {
          "id": "vol_diff",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "vol_diff",
          "handle": "result"
        },
        "target": {
          "id": "vol_z",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "std_vol20",
          "handle": "result"
        },
        "target": {
          "id": "vol_z",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "vol_z",
          "handle": "result"
        },
        "target": {
          "id": "vol_gt",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num_1",
          "handle": "result"
        },
        "target": {
          "id": "vol_gt",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "h"
        },
        "target": {
          "id": "high20",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "l"
        },
        "target": {
          "id": "low20",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "close_gt_high",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "high20",
          "handle": "result"
        },
        "target": {
          "id": "close_gt_high",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "close_lt_low",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "low20",
          "handle": "result"
        },
        "target": {
          "id": "close_lt_low",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "close_gt_high",
          "handle": "result"
        },
        "target": {
          "id": "long_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "are_gt",
          "handle": "result"
        },
        "target": {
          "id": "long_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "vol_gt",
          "handle": "result"
        },
        "target": {
          "id": "long_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "close_lt_low",
          "handle": "result"
        },
        "target": {
          "id": "short_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "are_gt",
          "handle": "result"
        },
        "target": {
          "id": "short_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "vol_gt",
          "handle": "result"
        },
        "target": {
          "id": "short_entry",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "long_exit",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "high20",
          "handle": "result"
        },
        "target": {
          "id": "long_exit",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "short_exit",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "low20",
          "handle": "result"
        },
        "target": {
          "id": "short_exit",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "long_exit",
          "handle": "result"
        },
        "target": {
          "id": "close_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "short_exit",
          "handle": "result"
        },
        "target": {
          "id": "close_any",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "long_entry",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "short_entry",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "short"
        }
      },
      {
        "source": {
          "id": "close_any",
          "handle": "result"
        },
        "target": {
          "id": "executor",
          "handle": "close"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:29:47.875270",
  "tags": [
    "breakout",
    "price range",
    "volume surge",
    "ATR",
    "technical pattern"
  ]
}