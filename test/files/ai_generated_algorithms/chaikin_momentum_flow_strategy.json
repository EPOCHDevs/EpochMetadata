{
  "id": "unique-id-001",
  "name": "Chaikin Momentum Flow Strategy",
  "description": "This strategy utilizes the Chaikin Money Flow (CMF) indicator to assess the buying and selling pressure in a stock over a specified period. By analyzing the relationship between price and volume, it aims to identify momentum shifts that can signal potential trading opportunities.",
  "algorithm_type": "Momentum",
  "prompt": "import pandas as pd\nimport numpy as np\n\ndef trading_strategy(data):\n    # Calculate the 14-day Chaikin Money Flow (CMF) for volume/price flow\n    def chaikin_money_flow(df, period=14):\n        mfv = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'] + 1e-10) * df['volume']\n        cmf = mfv.rolling(period).sum() / df['volume'].rolling(period).sum()\n        return cmf\n\n    # Calculate 21-day Keltner Channel (KC)\n    typical_price = (data['high'] + data['low'] + data['close']) / 3\n    ema_mid = typical_price.ewm(span=21, adjust=False).mean()\n    atr = data['high'].combine(data['low'], max) - data['low'].combine(data['high'], min)\n    ema_atr = atr.ewm(span=21, adjust=False).mean()\n    kc_upper = ema_mid + 2.2 * ema_atr\n    kc_lower = ema_mid - 2.2 * ema_atr\n\n    # Modified Williams %R over 10 periods: sensitive to high pivots\n    highest_high = data['high'].rolling(10).max()\n    lowest_low = data['low'].rolling(10).min()\n    willr_mod = 100 * ((highest_high - data['close']) / (highest_high - lowest_low + 1e-10))\n\n    # Calculate Linear Regression Slope (trend direction) over 9 bars\n    def linreg_slope(y, window=9):\n        x = np.arange(window)\n        slope = y.rolling(window).apply(lambda z: np.polyfit(x, z, 1)[0] if z.notna().all() else 0, raw=False)\n        return slope\n\n    data['cmf'] = chaikin_money_flow(data, 14)\n    data['kc_upper'], data['kc_lower'] = kc_upper, kc_lower\n    data['willr_mod'] = willr_mod\n    data['slope_9'] = linreg_slope(data['close'], 9)\n\n    # Signal logic:\n    # Go LONG if:\n    #   - Price closes above Keltner Channel upper band (KC breakout),\n    #   - CMF is positive (bullish money flow),\n    #   - Williams %R < 20 (just overbought: strong upward momentum/impulse bar),\n    #   - Linear regression slope is positive (trend confirmation)\n    # Go SHORT if:\n    #   - Price closes below Keltner Channel lower band,\n    #   - CMF is negative,\n    #   - Williams %R > 80 (just oversold: strong downward momentum),\n    #   - Linear regression slope is negative\n\n    data['signal'] = 0\n    buy_cond = (\n        (data['close'] > data['kc_upper']) &\n        (data['cmf'] > 0) &\n        (data['willr_mod'] < 20) &\n        (data['slope_9'] > 0)\n    )\n    sell_cond = (\n        (data['close'] < data['kc_lower']) &\n        (data['cmf'] < 0) &\n        (data['willr_mod'] > 80) &\n        (data['slope_9'] < 0)\n    )\n    data.loc[buy_cond, 'signal'] = 1\n    data.loc[sell_cond, 'signal'] = -1\n\n    return data",
  "blueprint": {
    "nodes": [
      {
        "id": "src",
        "type": "market_data_source",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "kc21",
        "type": "keltner_channels",
        "options": [
          {
            "id": "roll_period",
            "value": 21,
            "name": "",
            "isExposed": false
          },
          {
            "id": "band_multiplier",
            "value": 2.2,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "willr10",
        "type": "willr",
        "options": [
          {
            "id": "period",
            "value": 10,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "adline",
        "type": "ad",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": {
          "type": "day",
          "interval": 1
        }
      },
      {
        "id": "slope9",
        "type": "linregslope",
        "options": [
          {
            "id": "period",
            "value": 9,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num0",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 0,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num20",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 20,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "num80",
        "type": "number",
        "options": [
          {
            "id": "value",
            "value": 80,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_price_kc",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_price_kc",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_ad",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_ad",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_wr20",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_wr80",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "gt_slope",
        "type": "gt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "lt_slope",
        "type": "lt",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "all_long",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "all_short",
        "type": "agg_all_of",
        "options": [],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      },
      {
        "id": "executor1",
        "type": "trade_signal_executor",
        "options": [
          {
            "id": "closeIfIndecisive",
            "value": false,
            "name": "",
            "isExposed": false
          }
        ],
        "metadata": {
          "parentId": null
        },
        "timeframe": null
      }
    ],
    "edges": [
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "slope9",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "gt_price_kc",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "kc21",
          "handle": "upper_band"
        },
        "target": {
          "id": "gt_price_kc",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "src",
          "handle": "c"
        },
        "target": {
          "id": "lt_price_kc",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "kc21",
          "handle": "lower_band"
        },
        "target": {
          "id": "lt_price_kc",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adline",
          "handle": "result"
        },
        "target": {
          "id": "gt_ad",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num0",
          "handle": "result"
        },
        "target": {
          "id": "gt_ad",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "adline",
          "handle": "result"
        },
        "target": {
          "id": "lt_ad",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num0",
          "handle": "result"
        },
        "target": {
          "id": "lt_ad",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "willr10",
          "handle": "result"
        },
        "target": {
          "id": "lt_wr20",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num20",
          "handle": "result"
        },
        "target": {
          "id": "lt_wr20",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "willr10",
          "handle": "result"
        },
        "target": {
          "id": "gt_wr80",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num80",
          "handle": "result"
        },
        "target": {
          "id": "gt_wr80",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "slope9",
          "handle": "result"
        },
        "target": {
          "id": "gt_slope",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num0",
          "handle": "result"
        },
        "target": {
          "id": "gt_slope",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "slope9",
          "handle": "result"
        },
        "target": {
          "id": "lt_slope",
          "handle": "*0"
        }
      },
      {
        "source": {
          "id": "num0",
          "handle": "result"
        },
        "target": {
          "id": "lt_slope",
          "handle": "*1"
        }
      },
      {
        "source": {
          "id": "gt_price_kc",
          "handle": "result"
        },
        "target": {
          "id": "all_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_ad",
          "handle": "result"
        },
        "target": {
          "id": "all_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_wr20",
          "handle": "result"
        },
        "target": {
          "id": "all_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_slope",
          "handle": "result"
        },
        "target": {
          "id": "all_long",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_price_kc",
          "handle": "result"
        },
        "target": {
          "id": "all_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_ad",
          "handle": "result"
        },
        "target": {
          "id": "all_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "gt_wr80",
          "handle": "result"
        },
        "target": {
          "id": "all_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "lt_slope",
          "handle": "result"
        },
        "target": {
          "id": "all_short",
          "handle": "*"
        }
      },
      {
        "source": {
          "id": "all_long",
          "handle": "result"
        },
        "target": {
          "id": "executor1",
          "handle": "long"
        }
      },
      {
        "source": {
          "id": "all_short",
          "handle": "result"
        },
        "target": {
          "id": "executor1",
          "handle": "short"
        }
      }
    ]
  },
  "timestamp": "2025-06-23T15:55:55.415942",
  "tags": [
    "momentum",
    "trading",
    "CMF",
    "technical analysis",
    "volume"
  ]
}