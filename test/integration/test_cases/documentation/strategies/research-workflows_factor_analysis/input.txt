# Source: strategies/research-workflows.mdx:168
# Section: Research Workflows > Factor Analysis
# Type: partial_example

src = market_data_source()

# Current momentum
momentum_now = roc(period=20)(src.c)

# Future returns at various horizons (RESEARCH ONLY - look-ahead bias)
return_1d = forward_returns(period=1)(src.c)
return_5d = forward_returns(period=5)(src.c)
return_10d = forward_returns(period=10)(src.c)
return_20d = forward_returns(period=20)(src.c)

# Correlation between current momentum and future returns
corr_1d = rolling_corr(window=252)(x=momentum_now, y=return_1d)
corr_5d = rolling_corr(window=252)(x=momentum_now, y=return_5d)
corr_10d = rolling_corr(window=252)(x=momentum_now, y=return_10d)
corr_20d = rolling_corr(window=252)(x=momentum_now, y=return_20d)

# Table showing periods with strong correlations
has_strong_correlation = (abs(corr_1d) > 0.5) or (abs(corr_5d) > 0.5) or (abs(corr_10d) > 0.5) or (abs(corr_20d) > 0.5)

table_report(schema=TableReportSchema(
    title="Momentum Factor Correlations",
    select_key=SLOT0,
    columns=[
        TableColumnSchema(column_id=SLOT1, title="1 Day Corr"),
        TableColumnSchema(column_id=SLOT2, title="5 Days Corr"),
        TableColumnSchema(column_id=SLOT3, title="10 Days Corr"),
        TableColumnSchema(column_id=SLOT4, title="20 Days Corr")
    ]
))(
    has_strong_correlation,
    corr_1d,
    corr_5d,
    corr_10d,
    corr_20d
)
