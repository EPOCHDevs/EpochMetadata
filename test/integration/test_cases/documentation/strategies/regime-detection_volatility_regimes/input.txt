# Source: strategies/regime-detection.md:81
# Section: Regime Detection > Volatility Regimes
# Type: complete_strategy

src = market_data_source()

vol = yang_zhang(period=20, trading_periods=252)(src.l, src.h, src.o, src.c)

# Percentile-based regime detection using percentile_select
very_low = percentile_select(lookback=252, percentile=20)(vol.result, 0, 1)  # Below 20th percentile
high_vol = percentile_select(lookback=252, percentile=80)(vol.result, 1, 0)  # Above 80th percentile
normal_vol = (very_low == 0) and (high_vol == 0)  # Between 20th-80th percentile

# Expansion/contraction
vol_ma = sma(period=50)(vol.result)
expanding = vol.result > vol_ma * 1.2
contracting = vol.result < vol_ma * 0.8

# Vol breakout
vol_squeeze = contracting[5] and expanding

trade_signal_executor()(enter_long=vol_squeeze and normal_vol)
