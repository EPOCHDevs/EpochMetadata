# Source: strategies/chart-formations.md:87
# Section: Chart Formation Recognition > Flags & Pennants
# Type: complete_strategy

src = market_data_source()

bull_f = bull_flag()(src.h, src.l, src.c)
bear_f = bear_flag()(src.h, src.l, src.c)
pnt = pennant()(src.h, src.l, src.c)

bull_flag_break = bull_f.result and (src.c > bull_f.upper_bound)
bear_flag_break = bear_f.result and (src.c < bear_f.lower_bound)

# Vol decreases during formation, surges on breakout
vol_breakout = src.v > sma(period=20)(src.v) * 1.5

entry = bull_flag_break and vol_breakout
exit = bear_flag_break

trade_signal_executor()(enter_long=entry, exit_long=exit)
