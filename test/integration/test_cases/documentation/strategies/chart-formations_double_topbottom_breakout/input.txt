# Source: strategies/chart-formations.md:18
# Section: Chart Formation Recognition > Double Top/Bottom + Breakout
# Type: complete_strategy

src = market_data_source()

dt = double_top_bottom(pattern_type="Double Top Only", similarity_tolerance=0.02)(src.h, src.l, src.c)
db = double_top_bottom(pattern_type="Double Bottom Only", similarity_tolerance=0.02)(src.h, src.l, src.c)

# Wait for neckline break
dt_break = dt.pattern_detected and (src.c < dt.breakout_level)
db_break = db.pattern_detected and (src.c > db.breakout_level)

# Volume confirmation
vol_surge = src.v > sma(period=20)(src.v) * 1.3

entry = db_break and vol_surge
exit = dt_break and vol_surge

trade_signal_executor()(enter_long=entry, exit_long=exit)
