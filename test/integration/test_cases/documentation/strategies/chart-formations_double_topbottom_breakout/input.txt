# Source: strategies/chart-formations.md:18
# Section: Chart Formation Recognition > Double Top/Bottom + Breakout
# Type: complete_strategy

src = market_data_source()

dt = double_top(tolerance=0.02)(src.h, src.l, src.c)
db = double_bottom(tolerance=0.02)(src.h, src.l, src.c)

# Wait for neckline break
dt_break = dt.result and (src.c < dt.neckline)
db_break = db.result and (src.c > db.neckline)

# Volume confirmation
vol_surge = src.v > sma(period=20)(src.v) * 1.3

entry = db_break and vol_surge
exit = dt_break and vol_surge

trade_signal_executor()(enter_long=entry, exit_long=exit)
