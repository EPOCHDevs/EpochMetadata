# Source: strategies/patterns/combinations.mdx:55
# Section: Pattern Combinations > Regime-Adaptive Strategy
# Type: complete_strategy

src = market_data_source()

# Regime detection (ADX for trend strength)
adx_val = adx(period=14)(src.h, src.l, src.c)
trending = adx_val > 25
ranging = adx_val < 20

# Trend-following signals
ma_fast = ema(period=12)(src.c)
ma_slow = ema(period=26)(src.c)
trend_signal = ma_fast > ma_slow

# Mean reversion signals
rsi_val = rsi(period=14)(src.c)
oversold = rsi_val < 30
overbought = rsi_val > 70

# Adaptive entry (trend-follow in trends, mean-revert in ranges)
# Trend mode: use trend signal, Range mode: use oversold, Neutral: don't trade
entry_long = conditional_select(
    trending, trend_signal,
    ranging, oversold,
    0
)

# Trend mode: counter-trend, Range mode: overbought, Neutral: don't trade
entry_short = conditional_select(
    trending, not trend_signal,
    ranging, overbought,
    0
)

trade_signal_executor()(enter_long=entry_long, enter_short=entry_short)
