# Source: concepts/statistical-analysis.mdx:157
# Section: Statistical Analysis > Correlation & Covariance
# Type: complete_code

src = market_data_source(timeframe="1D")
spx = common_indices(index="SPX", timeframe="1D")()

stock_returns = roc(period=1)(src.c)
spx_returns = roc(period=1)(spx.c)

# Calculate rolling beta
beta_val = beta(window=60)(stock_returns, spx_returns)
# Beta > 1: More volatile than market
# Beta < 1: Less volatile than market
# Beta = 1: Matches market volatility


trade_signal_executor()(enter_long=beta_val)
