TEST FAILURE: control_flow/nested_ternaries
================================================================================
Generated: 2025-11-07 12:50:14
================================================================================

ERROR OUTPUT:
--------------------------------------------------------------------------------
control_flow/nested_ternaries
--------------------------------------------------------------------------------
/home/adesola/EpochLab/EpochScript/test/integration/script_integration_test.cpp:402: FAILED:
  REQUIRE_NOTHROW( output_data_map = orchestrator->ExecutePipeline(input_data_map) )
due to unexpected exception with messages:
  Found 172 integration test cases
  test_case.name := "control_flow/nested_ternaries"
  Expected graph.json:
  [{"type":"crossover","id":"cross","options":{},"inputs":{"SLOT0":
  ["fast#result"],"SLOT1":["slow#result"]},"timeframe":{"interval":1,"type":
  "hour"}},{"type":"ema","id":"fast","options":{"period":20},"inputs":{"SLOT":
  ["src#c"]},"timeframe":{"interval":1,"type":"hour"}},{"type":"gt","id":
  "gt_0","options":{},"inputs":{"SLOT0":["rsi14#result"],"SLOT1":
  ["number_2#result"]},"timeframe":{"interval":1,"type":"hour"}},{"type":
  "boolean_select","id":"ifexp_0","options":{},"inputs":{"condition":
  ["gt_0#result"],"true":["number_3#result"],"false":["cross#result"]},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"boolean_select","id":
  "ifexp_1","options":{},"inputs":{"condition":["lt_0#result"],"true":
  ["number_1#result"],"false":["ifexp_0#result"]},"timeframe":{"interval":1,
  "type":"hour"}},{"type":"lt","id":"lt_0","options":{},"inputs":{"SLOT0":
  ["rsi14#result"],"SLOT1":["number_0#result"]},"timeframe":{"interval":1,
  "type":"hour"}},{"type":"trade_signal_executor","id":"node_0","options":{},
  "inputs":{"enter_long":["ifexp_1#result"]},"timeframe":{"interval":1,"type":
  "hour"}},{"type":"number","id":"number_0","options":{"value":30},"inputs":{},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"number","id":"number_1",
  "options":{"value":1},"inputs":{},"timeframe":{"interval":1,"type":"hour"}},
  {"type":"number","id":"number_2","options":{"value":70},"inputs":{},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"number","id":"number_3",
  "options":{"value":0},"inputs":{},"timeframe":{"interval":1,"type":"hour"}},
  {"type":"rsi","id":"rsi14","options":{"period":14},"inputs":{"SLOT":["src#c"]
  },"timeframe":{"interval":1,"type":"hour"}},{"type":"ema","id":"slow",
  "options":{"period":50},"inputs":{"SLOT":["src#c"]},"timeframe":{"interval":
  1,"type":"hour"}},{"type":"market_data_source","id":"src","options":{},
  "inputs":{},"timeframe":{"interval":1,"type":"hour"}}]
  Actual graph.json:
  [{"type":"crossover","id":"cross","options":{},"inputs":{"SLOT1":
  ["slow#result"],"SLOT0":["fast#result"]},"timeframe":{"interval":1,"type":
  "hour"}},{"type":"ema","id":"fast","options":{"period":20},"inputs":{"SLOT":
  ["src#c"]},"timeframe":{"interval":1,"type":"hour"}},{"type":"gt","id":
  "gt_0","options":{},"inputs":{"SLOT1":["number_2#result"],"SLOT0":
  ["rsi14#result"]},"timeframe":{"interval":1,"type":"hour"}},{"type":
  "boolean_select","id":"ifexp_0","options":{},"inputs":{"false":
  ["cross#result"],"true":["number_3#result"],"condition":["gt_0#result"]},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"boolean_select","id":
  "ifexp_1","options":{},"inputs":{"false":["ifexp_0#result"],"true":
  ["number_1#result"],"condition":["lt_0#result"]},"timeframe":{"interval":1,
  "type":"hour"}},{"type":"lt","id":"lt_0","options":{},"inputs":{"SLOT1":
  ["number_0#result"],"SLOT0":["rsi14#result"]},"timeframe":{"interval":1,
  "type":"hour"}},{"type":"trade_signal_executor","id":"node_0","options":{},
  "inputs":{"enter_long":["ifexp_1#result"]},"timeframe":{"interval":1,"type":
  "hour"}},{"type":"number","id":"number_0","options":{"value":30},"inputs":{},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"number","id":"number_1",
  "options":{"value":1},"inputs":{},"timeframe":{"interval":1,"type":"hour"}},
  {"type":"number","id":"number_2","options":{"value":70},"inputs":{},
  "timeframe":{"interval":1,"type":"hour"}},{"type":"number","id":"number_3",
  "options":{"value":0},"inputs":{},"timeframe":{"interval":1,"type":"hour"}},
  {"type":"rsi","id":"rsi14","options":{"period":14},"inputs":{"SLOT":["src#c"]
  },"timeframe":{"interval":1,"type":"hour"}},{"type":"ema","id":"slow",
  "options":{"period":50},"inputs":{"SLOT":["src#c"]},"timeframe":{"interval":
  1,"type":"hour"}},{"type":"market_data_source","id":"src","options":{},
  "inputs":{},"timeframe":{"interval":1,"type":"hour"}}]
  Runtime testing for: control_flow/nested_ternaries
  Assets: 1
  Transform pipeline failed: Asset: AAPL-Stock, Transform: ifexp_0, Error:
  NotImplemented: Function 'if_else' has no kernel matching input types (bool,
  double, bool).
  Asset: AAPL-Stock, Transform: ifexp_1, Error: unordered_map::at.
  Asset: AAPL-Stock, Transform: node_0, Error: unordered_map::at.

[2025-11-07 12:41:49.059] [info] [orchestrator.cpp:138] Executing transform graph (9 transforms)
[2025-11-07 12:41:49.070] [info] [orchestrator.cpp:163] Transform pipeline completed successfully
[2025-11-07 12:41:49.071] [info] [orchestrator.cpp:173] FLOW DEBUG - Output data: 1H AAPL-Stock has 20 rows
[2025-11-07 12:41:49.102] [info] [orchestrator.cpp:138] Executing transform graph (10 transforms)
[2025-11-07 12:41:49.121] [info] [orchestrator.cpp:163] Transform pipeline completed successfully
[2025-11-07 12:41:49.122] [info] [orchestrator.cpp:173] FLOW DEBUG - Output data: 1D AAPL-Stock has 20 rows
[2025-11-07 12:41:49.156] [info] [orchestrator.cpp:138] Executing transform graph (4 transforms)
[2025-11-07 12:41:49.165] [info] [orchestrator.cpp:163] Transform pipeline completed successfully
[2025-11-07 12:41:49.167] [info] [orchestrator.cpp:173] FLOW DEBUG - Output data: 1D AAPL-Stock has 20 rows
[2025-11-07 12:41:49.196] [info] [orchestrator.cpp:138] Executing transform graph (5 transforms)
[2025-11-07 12:41:49.201] [info] [orchestrator.cpp:163] Transform pipeline completed successfully
[2025-11-07 12:41:49.201] [info] [orchestrator.cpp:173] FLOW DEBUG - Output data: 1D AAPL-Stock has 20 rows
[2025-11-07 12:41:49.285] [info] [orchestrator.cpp:138] Executing transform graph (6 transforms)
[2025-11-07 12:41:49.288] [warning] [execution_node.cpp:108] Asset(AAPL-Stock): Empty DataFrame provided to mul mul_0. Skipping transform
[2025-11-07 12:41:49.289] [info] [orchestrator.cpp:163] Transform pipeline completed successfully
[2025-11-07 12:41:49.290] [info] [orchestrator.cpp:173] FLOW DEBUG - Output data: 1D AAPL-Stock has 20 rows
-------------------------------------------------------------------------------
--------------------------------------------------------------------------------

================================================================================
TO FIX:
================================================================================
1. Review the error above
2. Fix the issue (compiler, script, or test)
3. Regenerate expected outputs:
   python3 scripts/test_helpers/generate_expected.py test/integration/test_cases/control_flow/nested_ternaries
4. Re-run tests:
   cmake-build-debug/bin/epoch_script_test "control_flow/nested_ternaries"
5. This error.txt will be auto-deleted on next successful run
================================================================================
