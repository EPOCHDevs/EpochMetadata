{
  "tests": [
    {
      "title": "Forward Returns Simple Period 1",
      "input": {
        "price": [
          10.0,
          20.0,
          30.0,
          40.0,
          50.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            1.0,
            0.5,
            0.3333333333333333,
            0.25,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 1,
        "return_type": "simple",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns Simple Period 2",
      "input": {
        "price": [
          100.0,
          110.0,
          121.0,
          133.1,
          146.41
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.21,
            0.20999999999999996,
            0.20999999999999996,
            null,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 2,
        "return_type": "simple",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns Simple Period 3",
      "input": {
        "price": [
          50.0,
          55.0,
          60.0,
          65.0,
          70.0,
          75.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.3,
            0.2727272727272727,
            0.25,
            null,
            null,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 3,
        "return_type": "simple",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns Log Period 1",
      "input": {
        "price": [
          10.0,
          20.0,
          30.0,
          40.0,
          50.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.6931471805599453,
            0.4054651081081644,
            0.2876820724517809,
            0.22314355131420976,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 1,
        "return_type": "log",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns Log Period 2",
      "input": {
        "price": [
          100.0,
          110.0,
          121.0,
          133.1,
          146.41
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.19062035960864954,
            0.19062035960864954,
            0.19062035960864954,
            null,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 2,
        "return_type": "log",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns with Negative Returns",
      "input": {
        "price": [
          100.0,
          90.0,
          80.0,
          70.0,
          60.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            -0.1,
            -0.1111111111111111,
            -0.125,
            -0.14285714285714285,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 1,
        "return_type": "simple",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns with Mixed Price Changes",
      "input": {
        "price": [
          100.0,
          105.0,
          95.0,
          110.0,
          100.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.05,
            -0.09523809523809523,
            0.15789473684210525,
            -0.09090909090909091,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 1,
        "return_type": "simple",
        "timeframe": "1D"
      }
    },
    {
      "title": "Forward Returns with Flat Prices",
      "input": {
        "price": [
          50.0,
          50.0,
          50.0,
          50.0,
          50.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "forward_returns#result": [
            0.0,
            0.0,
            0.0,
            0.0,
            null
          ]
        }
      },
      "options": {
        "transform_name": "forward_returns",
        "output_id": "forward_returns",
        "inputs": "SLOT: price",
        "period": 1,
        "return_type": "simple",
        "timeframe": "1D"
      }
    }
  ]
}
