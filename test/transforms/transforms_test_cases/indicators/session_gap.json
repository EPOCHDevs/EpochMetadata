{
  "tests": [
    {
      "title": "Up Gap Detection - Simple",
      "input": {
        "timestamp": [
          "2024-01-01T09:00:00",
          "2024-01-01T16:00:00",
          "2024-01-02T09:00:00",
          "2024-01-02T16:00:00"
        ],
        "o": [
          100.0,
          101.0,
          105.0,
          106.0
        ],
        "h": [
          102.0,
          103.0,
          108.0,
          110.0
        ],
        "l": [
          99.0,
          100.0,
          104.0,
          105.0
        ],
        "c": [
          101.0,
          102.0,
          107.0,
          108.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "session_gap#gap_size": [
            null,
            null,
            2.941176470588235,
            null
          ],
          "session_gap#gap_filled": [
            null,
            null,
            false,
            false
          ],
          "session_gap#gap_retrace": [
            null,
            null,
            0.3333333333333333,
            0.0
          ],
          "session_gap#psc": [
            null,
            null,
            102.0,
            102.0
          ],
          "session_gap#psc_timestamp": [
            null,
            null,
            "2024-01-01 16:00:00.000000000Z",
            "2024-01-01 16:00:00.000000000Z"
          ]
        }
      },
      "options": {
        "transform_name": "session_gap",
        "output_id": "session_gap",
        "inputs": "",
        "fill_percent": 100,
        "timeframe": "1H"
      },
      "timestamp_columns": [
        "timestamp"
      ],
      "index_column": "timestamp"
    },
    {
      "title": "Down Gap Detection - Simple",
      "input": {
        "timestamp": [
          "2024-01-01T09:00:00",
          "2024-01-01T16:00:00",
          "2024-01-02T09:00:00",
          "2024-01-02T16:00:00"
        ],
        "o": [
          100.0,
          104.0,
          95.0,
          94.0
        ],
        "h": [
          106.0,
          108.0,
          98.0,
          97.0
        ],
        "l": [
          99.0,
          103.0,
          92.0,
          91.0
        ],
        "c": [
          104.0,
          105.0,
          96.0,
          93.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "session_gap#gap_size": [
            null,
            null,
            -9.523809523809524,
            null
          ],
          "session_gap#gap_filled": [
            null,
            null,
            false,
            false
          ],
          "session_gap#gap_retrace": [
            null,
            null,
            0.3,
            0.2
          ],
          "session_gap#psc": [
            null,
            null,
            105.0,
            105.0
          ],
          "session_gap#psc_timestamp": [
            null,
            null,
            "2024-01-01 16:00:00.000000000Z",
            "2024-01-01 16:00:00.000000000Z"
          ]
        }
      },
      "options": {
        "transform_name": "session_gap",
        "output_id": "session_gap",
        "inputs": "",
        "fill_percent": 100,
        "timeframe": "1H"
      },
      "timestamp_columns": [
        "timestamp"
      ],
      "index_column": "timestamp"
    },
    {
      "title": "No Gap - Open equals previous close",
      "input": {
        "timestamp": [
          "2024-01-01T09:00:00",
          "2024-01-01T16:00:00",
          "2024-01-02T09:00:00",
          "2024-01-02T16:00:00"
        ],
        "o": [
          100.0,
          101.0,
          102.0,
          103.0
        ],
        "h": [
          103.0,
          104.0,
          108.0,
          109.0
        ],
        "l": [
          98.0,
          100.0,
          98.0,
          101.0
        ],
        "c": [
          101.0,
          102.0,
          105.0,
          106.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "session_gap#gap_size": [
            null,
            null,
            null,
            null
          ],
          "session_gap#gap_filled": [
            null,
            null,
            null,
            null
          ],
          "session_gap#gap_retrace": [
            null,
            null,
            null,
            null
          ],
          "session_gap#psc": [
            null,
            null,
            null,
            null
          ],
          "session_gap#psc_timestamp": [
            null,
            null,
            null,
            null
          ]
        }
      },
      "options": {
        "transform_name": "session_gap",
        "output_id": "session_gap",
        "inputs": "",
        "fill_percent": 100,
        "timeframe": "1H"
      },
      "timestamp_columns": [
        "timestamp"
      ],
      "index_column": "timestamp"
    },
    {
      "title": "Gap Size Calculation - Large up gap",
      "input": {
        "timestamp": [
          "2024-01-01T09:00:00",
          "2024-01-01T16:00:00",
          "2024-01-02T09:00:00",
          "2024-01-02T16:00:00"
        ],
        "o": [
          100.0,
          99.0,
          120.0,
          119.0
        ],
        "h": [
          102.0,
          101.0,
          125.0,
          124.0
        ],
        "l": [
          98.0,
          97.0,
          118.0,
          117.0
        ],
        "c": [
          99.0,
          100.0,
          122.0,
          121.0
        ]
      },
      "expect": {
        "type": "dataframe",
        "columns": {
          "session_gap#gap_size": [
            null,
            null,
            20.0,
            null
          ],
          "session_gap#gap_filled": [
            null,
            null,
            false,
            false
          ],
          "session_gap#gap_retrace": [
            null,
            null,
            0.1,
            0.15
          ],
          "session_gap#psc": [
            null,
            null,
            100.0,
            100.0
          ],
          "session_gap#psc_timestamp": [
            null,
            null,
            "2024-01-01 16:00:00.000000000Z",
            "2024-01-01 16:00:00.000000000Z"
          ]
        }
      },
      "options": {
        "transform_name": "session_gap",
        "output_id": "session_gap",
        "inputs": "",
        "fill_percent": 100,
        "timeframe": "1H"
      },
      "timestamp_columns": [
        "timestamp"
      ],
      "index_column": "timestamp"
    }
  ]
}