---
title: Research Workflows
page_type: concept
layout: default
order: 1
category: Strategies
description: Market research and analysis workflows using EpochScript for non-trading analysis
parent: ./index.md
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Tabs, Tab } from 'fumadocs-ui/components/tabs';

# Research Workflows

Market research and analysis using Epoch script (non-trading scripts).

---

## Research vs Strategy

### Key Differences

| Aspect | Trading Strategy | Research Script |
|--------|-----------------|-----------------|
| **Output** | Trade signals | Reports (charts, tables, cards) |
| **Executor** | Required (`trade_signal_executor`) | Not used |
| **Purpose** | Generate trades for backtesting/live | Analyze data, find patterns |
| **Look-ahead** | Prohibited (causes bias) | Allowed (historical analysis) |
| **Sink** | `trade_signal_executor()` | `gap_report()`, `table_report()`, etc. |

<Tabs items={['Trading Strategy', 'Research Script']}>
  <Tab value="Trading Strategy">
    ```python
    # MUST have trade_signal_executor
    src = market_data_source()
    signal = rsi(period=14)(src.c) < 30
    trade_signal_executor()(enter_long=signal)  # Required
    ```
  </Tab>

  <Tab value="Research Script">
    ```python
    # NO trade_signal_executor
    # Outputs reports instead
    src = market_data_source()
    gaps = session_gap(fill_percent=100, timeframe="1Min")()
    gap_report(fill_time_pivot_hour=12, histogram_bins=15)(
        gaps.gap_filled,
        gaps.gap_retrace,
        gaps.gap_size,
        gaps.psc,
        gaps.psc_timestamp
    )
    ```
  </Tab>
</Tabs>

---

## Gap Analysis

Research gap fill behavior across different markets and sessions.

```python
src = market_data_source()

# Overnight gaps - session boundaries
gaps = session_gap(fill_percent=100, timeframe="1Min")()
gap_report(fill_time_pivot_hour=12, histogram_bins=15)(
    gaps.gap_filled, gaps.gap_retrace, gaps.gap_size,
    gaps.psc, gaps.psc_timestamp
)

# Intraday gaps - trading halts (2% threshold for stocks)
intraday_gaps = bar_gap(fill_percent=100, min_gap_size=2.0, timeframe="1Min")()

# FX gaps - small moves (4 pips = 0.04%)
fx_gaps = bar_gap(fill_percent=100, min_gap_size=0.04, timeframe="1Min")()

# Session-specific gaps (compare London vs NY vs Asian)
london_gaps = session_gap(fill_percent=100, timeframe="1Min", session="London")()
```

<Callout type="info">
Report Output: Cards (fill rate %), Histograms (distribution), Tables (by hour/size). Research Questions: Fill rate by gap size? Time-to-fill patterns? Session variations? Day-of-week effects?
</Callout>

---

## Correlation Studies

Research lead-lag relationships, stability, and cross-asset dynamics.

```python
src = market_data_source()

# Lead-Lag Analysis: Does crypto volatility predict tech drawdowns?
crypto_vol = volatility(period=20)(src.c)
tech_dd = ulcer_index(period=20)(src.c)
concurrent_corr = rolling_corr(window=20)(x=crypto_vol, y=tech_dd)
# 5-day lag: shift crypto_vol forward by 5 periods
crypto_vol_lag5 = lag(period=5)(crypto_vol)
lag5_corr = rolling_corr(window=20)(x=crypto_vol_lag5, y=tech_dd)

# Stability: Short vs long window (regime shifts when divergence > 0.3)
corr_short = rolling_corr(window=20)(x=src.c, y=src.c)
corr_long = rolling_corr(window=60)(x=src.c, y=src.c)
regime_shift = abs(corr_short - corr_long) > 0.3

# Cross-Asset Matrix: Pairwise correlations for diversification analysis
corr_ab = rolling_corr(window=60)(x=src.c, y=src.c)
corr_ac = rolling_corr(window=60)(x=src.c, y=src.c)
avg_corr = (corr_ab + corr_ac) / 2.0  # Diversification measure

# Table report for time series analysis - show high correlation periods
high_corr = (abs(concurrent_corr) > 0.7) or (abs(lag5_corr) > 0.7)

table_report(schema=TableReportSchema(
    title="High Correlation Periods",
    select_key=SLOT0,
    columns=[
        TableColumnSchema(column_id=SLOT1, title="Concurrent Corr"),
        TableColumnSchema(column_id=SLOT2, title="Lag 5 Corr")
    ]
))(high_corr, concurrent_corr, lag5_corr)
```

<Callout type="tip">
Analysis: Compare lag correlations (if lag5_corr > concurrent_corr = leading indicator). Track regime shifts (correlation divergence). Monitor diversification (lower avg_corr = better).
</Callout>

---

## Pattern Research

Analyze pattern frequency, success rates, and directional bias.

```python
src = market_data_source()

# Head & Shoulders: Occurrence and target hit rate
hs = head_and_shoulders()()
breakdown = src.c < hs.neckline_level
target_hit = src.c <= hs.target

# Triangle Breakouts: Pattern type and detection
tri = triangles()()
future_return_5 = forward_returns(period=5)(src.c)  # Research only

# Table analysis - show detected patterns
table_report(schema=TableReportSchema(
    title="Pattern Analysis",
    select_key=SLOT0,
    columns=[
        TableColumnSchema(column_id=SLOT1, title="Target Hit"),
        TableColumnSchema(column_id=SLOT2, title="Triangle Type")
    ]
))(hs.pattern_detected, target_hit, tri.triangle_type)
```

---

## Factor Analysis

### Momentum Factor Decay

```python
src = market_data_source()

# Current momentum
momentum_now = roc(period=20)(src.c)

# Future returns at various horizons (RESEARCH ONLY - look-ahead bias)
return_1d = forward_returns(period=1)(src.c)
return_5d = forward_returns(period=5)(src.c)
return_10d = forward_returns(period=10)(src.c)
return_20d = forward_returns(period=20)(src.c)

# Correlation between current momentum and future returns
corr_1d = rolling_corr(window=252)(x=momentum_now, y=return_1d)
corr_5d = rolling_corr(window=252)(x=momentum_now, y=return_5d)
corr_10d = rolling_corr(window=252)(x=momentum_now, y=return_10d)
corr_20d = rolling_corr(window=252)(x=momentum_now, y=return_20d)

# Table showing periods with strong correlations
has_strong_correlation = (abs(corr_1d) > 0.5) or (abs(corr_5d) > 0.5) or (abs(corr_10d) > 0.5) or (abs(corr_20d) > 0.5)

table_report(schema=TableReportSchema(
    title="Momentum Factor Correlations",
    select_key=SLOT0,
    columns=[
        TableColumnSchema(column_id=SLOT1, title="1 Day Corr"),
        TableColumnSchema(column_id=SLOT2, title="5 Days Corr"),
        TableColumnSchema(column_id=SLOT3, title="10 Days Corr"),
        TableColumnSchema(column_id=SLOT4, title="20 Days Corr")
    ]
))(
    has_strong_correlation,
    corr_1d,
    corr_5d,
    corr_10d,
    corr_20d
)
```

<Callout type="info">
Interpretation: If correlation decreases with horizon: momentum mean-reverts. If correlation stable: momentum persists. Helps determine optimal holding period.
</Callout>

---

## Research Dashboard Workflow

Research scripts generate interactive dashboards with multiple report types for comprehensive analysis.

### Dashboard Components

Results appear in a dedicated Research Dashboard (separate from live trading charts):

**Available Report Types:**
1. Gap Reports - Comprehensive gap analysis (cards, charts, tables)
2. Table Reports - Filtered row display
3. Bar/Pie/Histogram/Line Charts - Visual analysis
4. Card Reports - Key metrics summary

### Workflow: Run → Review → Refine

```python
src = market_data_source()

# 1. Run research script
gaps = session_gap(fill_percent=100, timeframe="1Min")()
gap_report(fill_time_pivot_hour=12, histogram_bins=15)(
    gaps.gap_filled, gaps.gap_retrace, gaps.gap_size,
    gaps.psc, gaps.psc_timestamp
)

# 2. Dashboard shows: Cards (fill rate %), Histograms (distribution), Tables (by hour/size)
# 3. Interactive: Click rows to filter, hover for details, export CSV
# 4. Refine based on insights (e.g., gaps > 2% rarely fill → focus on smaller gaps)
```

---

## Research Best Practices

### 1. Document Assumptions

```python
src = market_data_source()

# GOOD: Clear assumptions
# Assumption: Gaps > 1.5% are significant for SPY
# Assumption: 100% fill = gap completely closed
gaps = session_gap(fill_percent=100, timeframe="1Min")()
```

### 2. Test Multiple Parameters

```python
src = market_data_source()

# Test different thresholds
gap_small = session_gap(fill_percent=100, min_gap_size=0.5)()
gap_medium = session_gap(fill_percent=100, min_gap_size=1.0)()
gap_large = session_gap(fill_percent=100, min_gap_size=2.0)()

# Compare fill rates
```

### 3. Look for Robustness

- Test across multiple assets
- Test across different time periods
- Test with different parameters
- Check statistical significance

<Callout type="warning">
Forward returns create look-ahead bias. Use ONLY for: Historical analysis, ML model training (on past data), Feature importance research. Never use in live trading!
</Callout>

---

## Summary

### Research Script Components

1. No Executor: Research scripts don't call `trade_signal_executor()`
2. Reporting Sinks: Use `gap_report()`, `table_report()`, card reports, charts
3. Look-Ahead Allowed: Can use `forward_returns()` for historical analysis (NOT for trading)
4. SQL Queries: `table_report()` supports complex aggregations
5. Statistical Analysis: Focus on understanding, not trading
6. Dashboard Output: Results appear in interactive research dashboard (separate from trading charts)

### Key Difference

**Strategy:** What should I trade?
**Research:** Why does this work? How robust is it?

---

**Next:** [Techniques](./techniques) | [Guidelines & Best Practices](./guidelines)
